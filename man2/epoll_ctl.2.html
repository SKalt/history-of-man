<!--
%%%LICENSE_START(GPLv2+_SW_3_PARA)
 This program is free software; you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation; either version 2 of the License, or
 (at your option) any later version.
.\"
 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.
.\"
You should have received a copy of the GNU General Public
License along with this manual; if not, see
&lt;http://www.gnu.org/licenses/&gt;.
%%%END_LICENSE
.\"
 Davide Libenzi &lt;davidel@xmailserver.org&gt;
.\"
.TH EPOLL_CTL 2 2012-04-15 "Linux" "Linux Programmer's Manual"
.SH NAME
epoll_ctl \- control interface for an epoll descriptor
.SH SYNOPSIS
.B #include &lt;sys/epoll.h&gt;
.sp
.BI "int epoll_ctl(int " epfd ", int " op ", int " fd \
", struct epoll_event *" event );
.SH DESCRIPTION
This system call performs control operations on the
.BR epoll (7)
instance
referred to by the file descriptor
.IR epfd .
It requests that the operation
.I op
be performed for the target file descriptor,
.IR fd .

Valid values for the
.I op
argument are :
.TP
.B EPOLL_CTL_ADD
Register the target file descriptor
.I fd
on the
.B epoll
instance referred to by the file descriptor
.I epfd
and associate the event
.I event
with the internal file linked to
.IR fd .
.TP
.B EPOLL_CTL_MOD
Change the event
.I event
associated with the target file descriptor
.IR fd .
.TP
.B EPOLL_CTL_DEL
Remove (deregister) the target file descriptor
.I fd
from the
.B epoll
instance referred to by
.IR epfd .
The
.I event
is ignored and can be NULL (but see BUGS below).
.PP
The
.I event
argument describes the object linked to the file descriptor
.IR fd .
The
.I struct epoll_event
is defined as :
.sp
.in +4n
.nf
typedef union epoll_data {
    void        *ptr;
    int          fd;
    uint32_t     u32;
    uint64_t     u64;
} epoll_data_t;

struct epoll_event {
    uint32_t     events;      /* Epoll events */
    epoll_data_t data;        /* User data variable */
};
.fi
.in

The
.I events
member is a bit set composed using the following available event
types:
.TP
.B EPOLLIN
The associated file is available for
.BR read (2)
operations.
.TP
.B EPOLLOUT
The associated file is available for
.BR write (2)
operations.
.TP
.BR EPOLLRDHUP " (since Linux 2.6.17)"
Stream socket peer closed connection,
or shut down writing half of connection.
(This flag is especially useful for writing simple code to detect
peer shutdown when using Edge Triggered monitoring.)
.TP
.B EPOLLPRI
There is urgent data available for
.BR read (2)
operations.
.TP
.B EPOLLERR
Error condition happened on the associated file descriptor.
.BR epoll_wait (2)
will always wait for this event; it is not necessary to set it in
.IR events .
.TP
.B EPOLLHUP
Hang up happened on the associated file descriptor.
.BR epoll_wait (2)
will always wait for this event; it is not necessary to set it in
.IR events .
.TP
.B EPOLLET
Sets the Edge Triggered behavior for the associated file descriptor.
The default behavior for
.B epoll
is Level Triggered.
See
.BR epoll (7)
for more detailed information about Edge and Level Triggered event
distribution architectures.
.TP
.BR EPOLLONESHOT " (since Linux 2.6.2)"
Sets the one-shot behavior for the associated file descriptor.
This means that after an event is pulled out with
.BR epoll_wait (2)
the associated file descriptor is internally disabled and no other events
will be reported by the
.B epoll
interface.
The user must call
.BR epoll_ctl ()
with
.B EPOLL_CTL_MOD
to rearm the file descriptor with a new event mask.
.SH RETURN VALUE
When successful,
.BR epoll_ctl ()
returns zero.
When an error occurs,
.BR epoll_ctl ()
returns \-1 and
.I errno
is set appropriately.
.SH ERRORS
.TP
.B EBADF
.I epfd
or
.I fd
is not a valid file descriptor.
.TP
.B EEXIST
.I op
was
.BR EPOLL_CTL_ADD ,
and the supplied file descriptor
.I fd
is already registered with this epoll instance.
.TP
.B EINVAL
.I epfd
is not an
.B epoll
file descriptor,
or
.I fd
is the same as
.IR epfd ,
or the requested operation
.I op
is not supported by this interface.
.TP
.B ENOENT
.I op
was
.B EPOLL_CTL_MOD
or
.BR EPOLL_CTL_DEL ,
and
.I fd
is not registered with this epoll instance.
.TP
.B ENOMEM
There was insufficient memory to handle the requested
.I op
control operation.
.TP
.B ENOSPC
The limit imposed by
.I /proc/sys/fs/epoll/max_user_watches
was encountered while trying to register
.RB ( EPOLL_CTL_ADD )
a new file descriptor on an epoll instance.
See
.BR epoll (7)
for further details.
.TP
.B EPERM
The target file
.I fd
does not support
.BR epoll .
.SH VERSIONS
.BR epoll_ctl ()
was added to the kernel in version 2.6.
To be precise: kernel 2.5.44.
The interface should be finalized by Linux kernel 2.5.66.
.SH CONFORMING TO
.BR epoll_ctl ()
is Linux-specific.
Library support is provided in glibc starting with version 2.3.2.
.SH NOTES
The
.B epoll
interface supports all file descriptors that support
.BR poll (2).
.SH BUGS
In kernel versions before 2.6.9, the
.B EPOLL_CTL_DEL
operation required a non-NULL pointer in
.IR event ,
even though this argument is ignored.
Since Linux 2.6.9,
.I event
can be specified as NULL
when using
.BR EPOLL_CTL_DEL .
Applications that need to be portable to kernels before 2.6.9
should specify a non-NULL pointer in
.IR event .
.SH SEE ALSO
.BR epoll_create (2),
.BR epoll_wait (2),
.BR poll (2),
.BR epoll (7)
-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Man page of EPOLL_CTL</TITLE>
</HEAD><BODY>
<H1>EPOLL_CTL</H1>
Section: Linux Programmer's Manual (2)<BR>Updated: 2012-04-15<BR><A HREF="#index">Index</A>
<A HREF="../index.html">Return to Main Contents</A><HR>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

epoll_ctl - control interface for an epoll descriptor
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<B>#include &lt;<A HREF="file:///usr/include/sys/epoll.h">sys/epoll.h</A>&gt;</B>

<P>
<B>int epoll_ctl(int </B><I>epfd</I><B>, int </B><I>op</I><B>, int </B><I>fd</I><B>, struct epoll_event *</B><I>event</I><B>);</B>

<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

This system call performs control operations on the
<B><A HREF="../man7/epoll.7.html">epoll</A></B>(7)

instance
referred to by the file descriptor
<I>epfd</I>.

It requests that the operation
<I>op</I>

be performed for the target file descriptor,
<I>fd</I>.

<P>
Valid values for the
<I>op</I>

argument are :
<DL COMPACT>
<DT><B>EPOLL_CTL_ADD</B>

<DD>
Register the target file descriptor
<I>fd</I>

on the
<B>epoll</B>

instance referred to by the file descriptor
<I>epfd</I>

and associate the event
<I>event</I>

with the internal file linked to
<I>fd</I>.

<DT><B>EPOLL_CTL_MOD</B>

<DD>
Change the event
<I>event</I>

associated with the target file descriptor
<I>fd</I>.

<DT><B>EPOLL_CTL_DEL</B>

<DD>
Remove (deregister) the target file descriptor
<I>fd</I>

from the
<B>epoll</B>

instance referred to by
<I>epfd</I>.

The
<I>event</I>

is ignored and can be NULL (but see BUGS below).
</DL>
<P>

The
<I>event</I>

argument describes the object linked to the file descriptor
<I>fd</I>.

The
<I>struct epoll_event</I>

is defined as :
<P>

<PRE>
typedef union epoll_data {
    void        *ptr;
    int          fd;
    uint32_t     u32;
    uint64_t     u64;
} epoll_data_t;

struct epoll_event {
    uint32_t     events;      /* Epoll events */
    epoll_data_t data;        /* User data variable */
};
</PRE>


<P>
The
<I>events</I>

member is a bit set composed using the following available event
types:
<DL COMPACT>
<DT><B>EPOLLIN</B>

<DD>
The associated file is available for
<B><A HREF="../man2/read.2.html">read</A></B>(2)

operations.
<DT><B>EPOLLOUT</B>

<DD>
The associated file is available for
<B><A HREF="../man2/write.2.html">write</A></B>(2)

operations.
<DT><B>EPOLLRDHUP</B> (since Linux 2.6.17)

<DD>
Stream socket peer closed connection,
or shut down writing half of connection.
(This flag is especially useful for writing simple code to detect
peer shutdown when using Edge Triggered monitoring.)
<DT><B>EPOLLPRI</B>

<DD>
There is urgent data available for
<B><A HREF="../man2/read.2.html">read</A></B>(2)

operations.
<DT><B>EPOLLERR</B>

<DD>
Error condition happened on the associated file descriptor.
<B><A HREF="../man2/epoll_wait.2.html">epoll_wait</A></B>(2)

will always wait for this event; it is not necessary to set it in
<I>events</I>.

<DT><B>EPOLLHUP</B>

<DD>
Hang up happened on the associated file descriptor.
<B><A HREF="../man2/epoll_wait.2.html">epoll_wait</A></B>(2)

will always wait for this event; it is not necessary to set it in
<I>events</I>.

<DT><B>EPOLLET</B>

<DD>
Sets the Edge Triggered behavior for the associated file descriptor.
The default behavior for
<B>epoll</B>

is Level Triggered.
See
<B><A HREF="../man7/epoll.7.html">epoll</A></B>(7)

for more detailed information about Edge and Level Triggered event
distribution architectures.
<DT><B>EPOLLONESHOT</B> (since Linux 2.6.2)

<DD>
Sets the one-shot behavior for the associated file descriptor.
This means that after an event is pulled out with
<B><A HREF="../man2/epoll_wait.2.html">epoll_wait</A></B>(2)

the associated file descriptor is internally disabled and no other events
will be reported by the
<B>epoll</B>

interface.
The user must call
<B>epoll_ctl</B>()

with
<B>EPOLL_CTL_MOD</B>

to rearm the file descriptor with a new event mask.
</DL>
<A NAME="lbAE">&nbsp;</A>
<H2>RETURN VALUE</H2>

When successful,
<B>epoll_ctl</B>()

returns zero.
When an error occurs,
<B>epoll_ctl</B>()

returns -1 and
<I>errno</I>

is set appropriately.
<A NAME="lbAF">&nbsp;</A>
<H2>ERRORS</H2>

<DL COMPACT>
<DT><B>EBADF</B>

<DD>
<I>epfd</I>

or
<I>fd</I>

is not a valid file descriptor.
<DT><B>EEXIST</B>

<DD>
<I>op</I>

was
<B>EPOLL_CTL_ADD</B>,

and the supplied file descriptor
<I>fd</I>

is already registered with this epoll instance.
<DT><B>EINVAL</B>

<DD>
<I>epfd</I>

is not an
<B>epoll</B>

file descriptor,
or
<I>fd</I>

is the same as
<I>epfd</I>,

or the requested operation
<I>op</I>

is not supported by this interface.
<DT><B>ENOENT</B>

<DD>
<I>op</I>

was
<B>EPOLL_CTL_MOD</B>

or
<B>EPOLL_CTL_DEL</B>,

and
<I>fd</I>

is not registered with this epoll instance.
<DT><B>ENOMEM</B>

<DD>
There was insufficient memory to handle the requested
<I>op</I>

control operation.
<DT><B>ENOSPC</B>

<DD>
The limit imposed by
<I>/proc/sys/fs/epoll/max_user_watches</I>

was encountered while trying to register
(<B>EPOLL_CTL_ADD</B>)

a new file descriptor on an epoll instance.
See
<B><A HREF="../man7/epoll.7.html">epoll</A></B>(7)

for further details.
<DT><B>EPERM</B>

<DD>
The target file
<I>fd</I>

does not support
<B>epoll</B>.

</DL>
<A NAME="lbAG">&nbsp;</A>
<H2>VERSIONS</H2>

<B>epoll_ctl</B>()

was added to the kernel in version 2.6.


<A NAME="lbAH">&nbsp;</A>
<H2>CONFORMING TO</H2>

<B>epoll_ctl</B>()

is Linux-specific.
Library support is provided in glibc starting with version 2.3.2.
<A NAME="lbAI">&nbsp;</A>
<H2>NOTES</H2>

The
<B>epoll</B>

interface supports all file descriptors that support
<B><A HREF="../man2/poll.2.html">poll</A></B>(2).

<A NAME="lbAJ">&nbsp;</A>
<H2>BUGS</H2>

In kernel versions before 2.6.9, the
<B>EPOLL_CTL_DEL</B>

operation required a non-NULL pointer in
<I>event</I>,

even though this argument is ignored.
Since Linux 2.6.9,
<I>event</I>

can be specified as NULL
when using
<B>EPOLL_CTL_DEL</B>.

Applications that need to be portable to kernels before 2.6.9
should specify a non-NULL pointer in
<I>event</I>.

<A NAME="lbAK">&nbsp;</A>
<H2>SEE ALSO</H2>

<B><A HREF="../man2/epoll_create.2.html">epoll_create</A></B>(2),

<B><A HREF="../man2/epoll_wait.2.html">epoll_wait</A></B>(2),

<B><A HREF="../man2/poll.2.html">poll</A></B>(2),

<B><A HREF="../man7/epoll.7.html">epoll</A></B>(7)

<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">RETURN VALUE</A><DD>
<DT><A HREF="#lbAF">ERRORS</A><DD>
<DT><A HREF="#lbAG">VERSIONS</A><DD>
<DT><A HREF="#lbAH">CONFORMING TO</A><DD>
<DT><A HREF="#lbAI">NOTES</A><DD>
<DT><A HREF="#lbAJ">BUGS</A><DD>
<DT><A HREF="#lbAK">SEE ALSO</A><DD>
</DL>
<HR>
This document was created by
<A HREF="http://localhost/cgi-bin/man/man2html">man2html</A>,
using the manual pages.<BR>
Time: 03:19:19 GMT, April 20, 2020
</BODY>
</HTML>
