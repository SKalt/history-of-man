<!--
Copyright 1993 Rickard E. Faith (faith@cs.unc.edu)
-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Man page of FSYNC</TITLE>
</HEAD><BODY>
<H1>FSYNC</H1>
Section: Linux Programmer's Manual (2)<BR>Updated: 2001-04-18<BR><A HREF="#index">Index</A>
<A HREF="../index.html">Return to Main Contents</A><HR>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

fsync, fdatasync - synchronize a file's complete in-core state with that on disk
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<B>#include &lt;<A HREF="file:///usr/include/unistd.h">unistd.h</A>&gt;</B>

<P>
<B>int fsync(int </B><I>fd</I><B>);</B>

<P>
<B>int fdatasync(int </B><I>fd</I><B>);</B>

<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<B>fsync</B>()

copies all in-core parts of a file to disk, and waits until the
device reports that all parts are on stable storage.
It also updates metadata stat information. It does not necessarily ensure
that the entry in the directory containing the file has also reached disk.
For that an explicit
<B>fsync</B>()

on the file descriptor of the directory is also needed.
<P>
<B>fdatasync</B>()

does the same as
<B>fsync</B>()

but only flushes user data, not the meta data like the st_atime or 
st_mtime
(respectively, time of last access and
time of last modification; see
<B><A HREF="../man2/stat.2.html">stat</A></B>(2))<B>.</B>

<A NAME="lbAE">&nbsp;</A>
<H2>RETURN VALUE</H2>

On success, zero is returned.  On error, -1 is returned, and
<I>errno</I>

is set appropriately.
<A NAME="lbAF">&nbsp;</A>
<H2>ERRORS</H2>

<DL COMPACT>
<DT><B>EBADF</B>

<DD>
<I>fd</I>

is not a valid file descriptor open for writing.
<DT><B>EIO</B>

<DD>
An error occurred during synchronization.
<DT><B>EROFS</B>, <B>EINVAL</B>

<DD>
<I>fd</I>

is bound to a special file which does not support synchronization.
</DL>
<A NAME="lbAG">&nbsp;</A>
<H2>NOTES</H2>

In case the hard disk has write cache enabled,
the data may not really be on permanent storage when
<B>fsync</B>()

/ 
<B>fdatasync</B>()

return.



<P>

When an ext2 file system is mounted with the
<I>sync</I>

option, directory entries are also implicitly synced by
<B>fsync</B>().

<P>

On kernels before 2.4,
<B>fsync</B>()

on big files can be inefficient.
An alternative might be to use the
<I>O_SYNC</I>

flag to
<B><A HREF="../man2/open.2.html">open</A></B>(2).

<A NAME="lbAH">&nbsp;</A>
<H2>CONFORMING TO</H2>

POSIX.1b (formerly POSIX.4) 
<A NAME="lbAI">&nbsp;</A>
<H2>SEE ALSO</H2>

<B><A HREF="../man2/bdflush.2.html">bdflush</A></B>(2),

<B><A HREF="../man2/open.2.html">open</A></B>(2),

<B><A HREF="../man2/sync.2.html">sync</A></B>(2),

<B><A HREF="../man8/mount.8.html">mount</A></B>(8),

<B><A HREF="../man8/sync.8.html">sync</A></B>(8),

<B><A HREF="../man8/update.8.html">update</A></B>(8)

<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">RETURN VALUE</A><DD>
<DT><A HREF="#lbAF">ERRORS</A><DD>
<DT><A HREF="#lbAG">NOTES</A><DD>
<DT><A HREF="#lbAH">CONFORMING TO</A><DD>
<DT><A HREF="#lbAI">SEE ALSO</A><DD>
</DL>
<HR>
This document was created by
<A HREF="http://localhost/cgi-bin/man/man2html">man2html</A>,
using the manual pages.<BR>
Time: 02:18:29 GMT, April 20, 2020
</BODY>
</HTML>
