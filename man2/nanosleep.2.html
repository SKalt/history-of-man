<!--
Copyright (C) Markus Kuhn, 1996
-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Man page of NANOSLEEP</TITLE>
</HEAD><BODY>
<H1>NANOSLEEP</H1>
Section: Linux Programmer's Manual (2)<BR>Updated: 2007-07-26<BR><A HREF="#index">Index</A>
<A HREF="../index.html">Return to Main Contents</A><HR>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

nanosleep - pause execution for a specified time
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<B>#include &lt;<A HREF="file:///usr/include/time.h">time.h</A>&gt;</B>

<P>
<B>int nanosleep(const struct timespec *</B><I>req</I><B>, struct timespec *</B><I>rem</I><B>);</B>

<P>

Feature Test Macro Requirements for glibc (see
<B><A HREF="../man7/feature_test_macros.7.html">feature_test_macros</A></B>(7)):


<P>
<B>nanosleep</B>():

_POSIX_C_SOURCE&nbsp;&gt;=&nbsp;199309L
<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<B>nanosleep</B>()

delays the execution of the program for at least the time specified in
<I>*req</I>.

The function can return earlier if a signal has been delivered to the
process.
In this case, it returns -1, sets <I>errno</I> to
<B>EINTR</B>,

and writes the
remaining time into the structure pointed to by
<I>rem</I>

unless
<I>rem</I>

is NULL.
The value of
<I>*rem</I>

can then be used to call
<B>nanosleep</B>()

again and complete the specified pause.
<P>
The structure
<I>timespec</I>

is used to specify intervals of time with nanosecond precision.
It is
specified in
<I>&lt;<A HREF="file:///usr/include/time.h">time.h</A>&gt;</I>

and has the form
<P>
<DL COMPACT><DT><DD>
<PRE>
struct timespec {
    time_t tv_sec;        /* seconds */
    long   tv_nsec;       /* nanoseconds */
};
</PRE>

</DL>

<P>

The value of the nanoseconds field must be in the range 0 to 999999999.
<P>
Compared to
<B><A HREF="../man3/sleep.3.html">sleep</A></B>(3)

and
<B><A HREF="../man3/usleep.3.html">usleep</A></B>(3),

<B>nanosleep</B>()

has the advantage of not affecting any signals, it is standardized by
POSIX, it provides higher timing resolution, and it allows to continue
a sleep that has been interrupted by a signal more easily.
<A NAME="lbAE">&nbsp;</A>
<H2>RETURN VALUE</H2>

On successfully sleeping for the requested interval,
<B>nanosleep</B>()

returns 0.
If the call is interrupted by a signal handler or encounters an error,
then it returns -1, with
<I>errno</I>

set to indicate the error.
<A NAME="lbAF">&nbsp;</A>
<H2>ERRORS</H2>

<DL COMPACT>
<DT><B>EFAULT</B>

<DD>
Problem with copying information from user space.
<DT><B>EINTR</B>

<DD>
The pause has been interrupted by a non-blocked signal that was
delivered to the process.
The remaining sleep time has been written
into <I>*rem</I> so that the process can easily call
<B>nanosleep</B>()

again and continue with the pause.
<DT><B>EINVAL</B>

<DD>
The value in the
<I>tv_nsec</I>

field was not in the range 0 to 999999999 or
<I>tv_sec</I>

was negative.
</DL>
<A NAME="lbAG">&nbsp;</A>
<H2>CONFORMING TO</H2>

POSIX.1-2001.
<A NAME="lbAH">&nbsp;</A>
<H2>BUGS</H2>

The current implementation of
<B>nanosleep</B>()

is based on the normal kernel timer mechanism, which has a resolution
of 1/<I>HZ</I>&nbsp;s (see
<B><A HREF="../man7/time.7.html">time</A></B>(7)).

Therefore,
<B>nanosleep</B>()

pauses always for at least the specified time, however it can take up
to 10 ms longer than specified until the process becomes runnable
again.
For the same reason, the value returned in case of a delivered
signal in <I>*rem</I> is usually rounded to the next larger multiple of
1/<I>HZ</I>&nbsp;s.
<A NAME="lbAI">&nbsp;</A>
<H3>Old behavior</H3>

In order to support applications requiring much more precise pauses
(e.g., in order to control some time-critical hardware),
<B>nanosleep</B>()

would handle pauses of up to 2&nbsp;ms by busy waiting with microsecond
precision when called from a process scheduled under a real-time policy
like
<B>SCHED_FIFO</B>

or
<B>SCHED_RR</B>.

This special extension was removed in kernel 2.5.39,
hence is still present in
current 2.4 kernels, but not in 2.6 kernels.
<P>

In Linux 2.4, if
<B>nanosleep</B>()

is stopped by a signal (e.g.,
<B>SIGTSTP</B>),

then the call fails with the error
<B>EINTR</B>

after the process is resumed by a
<B>SIGCONT</B>

signal.
If the system call is subsequently restarted,
then the time that the process spent in the stopped state is
<I>not</I> counted against the sleep interval.
<A NAME="lbAJ">&nbsp;</A>
<H2>SEE ALSO</H2>

<B><A HREF="../man2/sched_setscheduler.2.html">sched_setscheduler</A></B>(2),

<B><A HREF="../man3/sleep.3.html">sleep</A></B>(3),

<B><A HREF="../man3/timer_create.3.html">timer_create</A></B>(3),

<B><A HREF="../man3/usleep.3.html">usleep</A></B>(3),

<B><A HREF="../man7/time.7.html">time</A></B>(7)

<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">RETURN VALUE</A><DD>
<DT><A HREF="#lbAF">ERRORS</A><DD>
<DT><A HREF="#lbAG">CONFORMING TO</A><DD>
<DT><A HREF="#lbAH">BUGS</A><DD>
<DL>
<DT><A HREF="#lbAI">Old behavior</A><DD>
</DL>
<DT><A HREF="#lbAJ">SEE ALSO</A><DD>
</DL>
<HR>
This document was created by
<A HREF="http://localhost/cgi-bin/man/man2html">man2html</A>,
using the manual pages.<BR>
Time: 02:49:31 GMT, April 20, 2020
</BODY>
</HTML>
