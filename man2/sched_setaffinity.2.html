<!--
Copyright (C) 2002 Robert Love
-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Man page of SCHED_SETAFFINITY</TITLE>
</HEAD><BODY>
<H1>SCHED_SETAFFINITY</H1>
Section: Linux Programmer's Manual (2)<BR>Updated: 2004-04-22<BR><A HREF="#index">Index</A>
<A HREF="../index.html">Return to Main Contents</A><HR>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

sched_setaffinity, sched_getaffinity - set and get a process's CPU affinity
mask
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<B>#include &lt;<A HREF="file:///usr/include/sched.h">sched.h</A>&gt;</B>

<P>
<B>int sched_setaffinity(pid_t </B><I>pid</I><B>, unsigned int </B><I>len</I><B>,</B>

<B>unsigned long *</B><I>mask</I><B>);</B>

<P>
<B>int sched_getaffinity(pid_t </B><I>pid</I><B>, unsigned int </B><I>len</I><B>,</B>

<B>unsigned long *</B><I>mask</I><B>);</B>

<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<B>sched_setaffinity</B>

sets the CPU affinity mask of the process denoted by
<I>pid</I>.

If
<I>pid</I>

is zero, then the current process is used.
<P>
The affinity mask is represented by the bitmask stored in
<I>mask</I>.

The least significant bit corresponds to the first logical processor number on
the system, while the most significant bit corresponds to the last logical
processor number on the system.  A set bit corresponds to a legally schedulable
CPU while an unset bit corresponds to an illegally schedulable CPU.  In other
words, a process is bound to and will only run on processors whose
corresponding bit is set.  Usually, all bits in the mask are set.
<P>
The argument
<I>len</I>

is the length (in bytes) of the data pointed to by
<I>mask</I>.

Normally this is the size of a word on the system.  For compatibility with
future versions of the Linux kernel, since this size can change, the bitmask
supplied must be at least as large as the affinity mask stored in the kernel.
<P>
The function
<B>sched_getaffinity</B>

writes into the pointer supplied by
<I>mask</I>

that has size
<I>len</I>

the affinity mask of process
<I>pid</I>.

If
<I>pid</I>

is zero, then the mask of the current process is returned.
<P>
<A NAME="lbAE">&nbsp;</A>
<H2>RETURN VALUE</H2>

On success,
<B>sched_setaffinity</B>

returns 0.
On error, -1 is returned, and
<I>errno</I>

is set appropriately.
<P>
On success,
<B>sched_getaffinity</B>

always returns the size (in bytes) of the affinity mask used by the kernel.
On error, -1 is returned, and
<I>errno</I>

is set appropriately.
<P>
<A NAME="lbAF">&nbsp;</A>
<H2>ERRORS</H2>

<DL COMPACT>
<DT><B>EFAULT</B>

<DD>
A supplied memory address was invalid.
<DT><B>EINVAL</B>

<DD>
The affinity bitmask 
<I>mask</I>

contains no processors that are physically on the system, or the length
<I>len</I>

is smaller than the size of the affinity mask used by the kernel.
<DT><B>EPERM</B>

<DD>
The calling process does not have appropriate privileges.
The process calling
<B>sched_setaffinity</B>

needs an effective user ID equal to the user ID or effective user ID
of the process identified by
<I>pid</I>,

or it must possess the
<I>CAP_SYS_NICE</I>

capability.
<DT><B>ESRCH</B>

<DD>
The process whose ID is <I>pid</I> could not be found.
</DL>
<A NAME="lbAG">&nbsp;</A>
<H2>HISTORY</H2>

The affinity syscalls were introduced in Linux kernel 2.5.8.
The library calls were introduced in glibc 2.3, and are still in
glibc 2.3.2. Later glibc 2.3.2 development versions changed this
interface to one without the
<I>len</I>

field, and still later versions reverted again. The glibc prototype is now
<P>
<PRE>
/* Set the CPU affinity for a task */
extern int sched_setaffinity (pid_t pid, size_t cpusetsize,
                              const cpu_set_t *cpuset);

/* Get the CPU affinity for a task */
extern int sched_getaffinity (pid_t pid, size_t cpusetsize,
                              cpu_set_t *cpuset);
</PRE>

<A NAME="lbAH">&nbsp;</A>
<H2>SEE ALSO</H2>

<B><A HREF="../man2/getpriority.2.html">getpriority</A></B>(2),

<B><A HREF="../man2/nice.2.html">nice</A></B>(2),

<B><A HREF="../man2/sched_get_priority_max.2.html">sched_get_priority_max</A></B>(2),

<B><A HREF="../man2/sched_get_priority_min.2.html">sched_get_priority_min</A></B>(2),

<B><A HREF="../man2/sched_getscheduler.2.html">sched_getscheduler</A></B>(2),

<B><A HREF="../man2/sched_setscheduler.2.html">sched_setscheduler</A></B>(2),

<B><A HREF="../man2/setpriority.2.html">setpriority</A></B>(2),

<B><A HREF="../man7/capabilities.7.html">capabilities</A></B>(7)

<P>

<B><A HREF="../man2/sched_setscheduler.2.html">sched_setscheduler</A></B>(2)

has a description of the Linux scheduling scheme.
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">RETURN VALUE</A><DD>
<DT><A HREF="#lbAF">ERRORS</A><DD>
<DT><A HREF="#lbAG">HISTORY</A><DD>
<DT><A HREF="#lbAH">SEE ALSO</A><DD>
</DL>
<HR>
This document was created by
<A HREF="http://localhost/cgi-bin/man/man2html">man2html</A>,
using the manual pages.<BR>
Time: 02:10:04 GMT, April 20, 2020
</BODY>
</HTML>
