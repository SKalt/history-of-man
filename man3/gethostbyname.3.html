<!--
Copyright 1993 David Metcalfe (david@prism.demon.co.uk)
-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Man page of GETHOSTBYNAME</TITLE>
</HEAD><BODY>
<H1>GETHOSTBYNAME</H1>
Section: Linux Programmer's Manual (3)<BR>Updated: 2004-10-31<BR><A HREF="#index">Index</A>
<A HREF="../index.html">Return to Main Contents</A><HR>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

gethostbyname, gethostbyaddr, sethostent, gethostent, endhostent,
herror, hstrerror - get network host entry
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<PRE>
<B>#include &lt;<A HREF="file:///usr/include/netdb.h">netdb.h</A>&gt;</B>
<B>extern int h_errno;</B>

<B>struct hostent *gethostbyname(const char *</B><I>name</I><B>);</B>

<B>#include &lt;<A HREF="file:///usr/include/sys/socket.h">sys/socket.h</A>&gt;</B>       /* for AF_INET */
<B>struct hostent *</B>
<BR>
<B>gethostbyaddr(const void *</B><I>addr</I><B>, int </B><I>len</I><B>, int </B><I>type</I><B>);</B>

<B>void sethostent(int </B><I>stayopen</I><B>);</B>

<B>void endhostent(void);</B>

<B>void herror(const char *</B><I>s</I><B>);</B>

<B>const char *hstrerror(int </B><I>err</I><B>);</B>

/* SYSV/POSIX extension */
<BR>
<B>struct hostent *gethostent(void);</B>

/* GNU extensions */
<BR>
<B>struct hostent *gethostbyname2(const char *</B><I>name</I><B>, int </B><I>af</I><B>);</B>

<B>int gethostent_r(</B>
<B>  struct hostent *</B><I>ret</I><B>, char *</B><I>buf</I><B>, size_t </B><I>buflen</I><B>,</B>
<B>  struct hostent **</B><I>result</I><B>, int *</B><I>h_errnop</I><B>);</B>

<B>int gethostbyname_r(const char *</B><I>name</I><B>,</B>
<B>  struct hostent *</B><I>ret</I><B>, char *</B><I>buf</I><B>, size_t </B><I>buflen</I><B>,</B>
<B>  struct hostent **</B><I>result</I><B>, int *</B><I>h_errnop</I><B>);</B>

<B>int gethostbyname2_r(const char *</B><I>name</I><B>, int </B><I>af,</I>
<B>  struct hostent *</B><I>ret</I><B>, char *</B><I>buf</I><B>, size_t </B><I>buflen</I><B>,</B>
<B>  struct hostent **</B><I>result</I><B>, int *</B><I>h_errnop</I><B>);</B>
</PRE>

<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

The
<B>gethostbyname</B>()

function returns a structure of type
<I>hostent</I>

for the given host
<I>name</I>.

Here
<I>name</I>

is either a host name, or an IPv4 address in standard dot notation,
or an IPv6 address in colon (and possibly dot) notation.
(See RFC&nbsp;1884 for the description of IPv6 addresses.)
If
<I>name</I>

is an IPv4 or IPv6 address, no lookup is performed and
<B>gethostbyname</B>()

simply copies
<I>name</I>

into the
<I>h_name</I>

field and its
<I>struct in_addr</I>

equivalent into the
<I>h_addr_list[0]</I>

field of the returned
<I>hostent</I>

structure.
If
<I>name</I>

doesn't end in a dot and the environment variable
<B>HOSTALIASES</B>

is set, the alias file pointed to by
<B>HOSTALIASES</B>

will first be searched for
<I>name</I>

(see
<B><A HREF="../man7/hostname.7.html">hostname</A></B>(7)

for the file format).
The current domain and its parents are searched unless <I>name</I>
ends in a dot.
<P>

The <B>gethostbyaddr</B>() function returns a structure of type <I>hostent</I>
for the given host address <I>addr</I> of length <I>len</I> and address type
<I>type</I>.  Valid address types are
<B>AF_INET</B>

and
<B>AF_INET6</B>.

The host address argument is a pointer to a struct of a type depending
on the address type, for example a <B>struct in_addr *</B> (probably
obtained via a call to <I>inet_addr</I>()) for address type AF_INET.
<P>

The <B>sethostent</B>() function specifies, if <I>stayopen</I> is true (1), 
that a connected TCP socket should be used for the name server queries and 
that the connection should remain open during successive queries.  Otherwise, 
name server queries will use UDP datagrams.
<P>

The <B>endhostent</B>() function ends the use of a TCP connection for name
server queries.
<P>

The (obsolete) <B>herror</B>() function prints the error message associated
with the current value of <I>h_errno</I> on stderr.
<P>

The (obsolete) <B>hstrerror</B>() function takes an error number
(typically <I>h_errno</I>) and returns the corresponding message string.
<P>

The domain name queries carried out by <B>gethostbyname</B>() and
<B>gethostbyaddr</B>() use a combination of any or all of the name server
<B><A HREF="../man8/named.8.html">named</A></B>(8),

a broken out line from <I>/etc/hosts</I>, and the Network
Information Service (NIS or YP), depending upon the contents of the
<I>order</I> line in
<I>/etc/host.conf</I>.

(See
<B>resolv+</B>(8)).

The default action is to query
<B><A HREF="../man8/named.8.html">named</A></B>(8),

followed by
<I>/etc/hosts</I>.

<P>

The <I>hostent</I> structure is defined in <I>&lt;<A HREF="file:///usr/include/netdb.h">netdb.h</A>&gt;</I> as follows:
<P>
<DL COMPACT><DT><DD>
<PRE>

struct hostent {
        char    *h_name;        /* official name of host */
        char    **h_aliases;    /* alias list */
        int     h_addrtype;     /* host address type */
        int     h_length;       /* length of address */
        char    **h_addr_list;  /* list of addresses */
}
#define h_addr  h_addr_list[0]  /* for backward compatibility */

</PRE>

</DL>

<P>

The members of the <I>hostent</I> structure are:
<DL COMPACT>
<DT><I>h_name</I>

<DD>
The official name of the host.
<DT><I>h_aliases</I>

<DD>
A zero-terminated array of alternative names for the host.
<DT><I>h_addrtype</I>

<DD>
The type of address; always
<B>AF_INET</B>

or
<B>AF_INET6</B>

at present.
<DT><I>h_length</I>

<DD>
The length of the address in bytes.
<DT><I>h_addr_list</I>

<DD>
A zero-terminated array of network addresses for the host in network byte
order.
<DT><I>h_addr</I>

<DD>
The first address in <I>h_addr_list</I> for backward compatibility.
</DL>
<A NAME="lbAE">&nbsp;</A>
<H2>RETURN VALUE</H2>

The
<B>gethostbyname</B>()

and
<B>gethostbyaddr</B>()

functions return the
<I>hostent</I>

structure or a NULL pointer if an error occurs.  On error, the
<I>h_errno</I>

variable holds an error number.
When non-NULL, the return value may point at static data, see the notes below.
<A NAME="lbAF">&nbsp;</A>
<H2>ERRORS</H2>

The variable <I>h_errno</I> can have the following values:
<DL COMPACT>
<DT><B>HOST_NOT_FOUND</B>

<DD>
The specified host is unknown.
<DT><B>NO_ADDRESS</B> or <B>NO_DATA</B>

<DD>
The requested name is valid but does not have an IP address.
<DT><B>NO_RECOVERY</B>

<DD>
A non-recoverable name server error occurred.
<DT><B>TRY_AGAIN</B>

<DD>
A temporary error occurred on an authoritative name server.  Try again
later.
</DL>
<A NAME="lbAG">&nbsp;</A>
<H2>FILES</H2>

<DL COMPACT>
<DT><I>/etc/host.conf</I>

<DD>
resolver configuration file
<DT><I>/etc/hosts</I>

<DD>
host database file
</DL>
<A NAME="lbAH">&nbsp;</A>
<H2>CONFORMING TO</H2>

4.3BSD.
<A NAME="lbAI">&nbsp;</A>
<H2>SYSV/POSIX EXTENSION</H2>

POSIX requires the
<B>gethostent</B>()

call, that should return the next entry in the host data base.
When using DNS/BIND this does not make much sense, but it may
be reasonable if the host data base is a file that can be read
line by line. On many systems a routine of this name reads
from the file
<I>/etc/hosts</I>.


It may be available only when the library was built without DNS support.

The glibc version will ignore ipv6 entries. This function is not reentrant,
and glibc adds a reentrant version
<B>gethostent_r</B>().

<A NAME="lbAJ">&nbsp;</A>
<H2>GNU EXTENSIONS</H2>

Glibc2 also has a
<B>gethostbyname2</B>()

that works like
<B>gethostbyname</B>(),

but permits to specify the address family to which the address must belong.
<P>

Glibc2 also has reentrant versions
<B>gethostbyname_r</B>()

and
<B>gethostbyname2_r</B>().

These return 0 on success and non-zero on error. The result of the call
is now stored in the struct with address
<I>ret</I>.

After the call,
*<I>result</I>

will be NULL on error or point to the result on success.
Auxiliary data is stored in the buffer
<I>buf</I>

of length
<I>buflen</I>.

(If the buffer is too small, these functions will return
<B>ERANGE</B>.)

No global variable
<I>h_errno</I>

is modified, but the address of a variable in which to store error numbers
is passed in
<I>h_errnop</I>.

<A NAME="lbAK">&nbsp;</A>
<H2>NOTES</H2>

The functions
<B>gethostbyname</B>()

and
<B>gethostbyaddr</B>()

may return pointers to static data, which may be overwritten by
later calls. Copying the
<I>struct hostent</I>

does not suffice, since it contains pointers; a deep copy is required.
<P>

The SUS-v2 standard is buggy and declares the
<I>len</I>

parameter of
<B>gethostbyaddr</B>()

to be of type
<I>size_t</I>.

(That is wrong, because it has to be
<I>int</I>,

and
<I>size_t</I>

is not. POSIX 1003.1-2001 makes it
<I>socklen_t</I>,

which is OK.)
<P>

The BSD prototype for
<B>gethostbyaddr</B>()

uses
<I>const char *</I>

for the first argument.
<P>

POSIX 1003.1-2001 marks
<B>gethostbyaddr</B>()

and
<B>gethostbyname</B>()

obsolescent. See
<B><A HREF="../man3/getaddrinfo.3.html">getaddrinfo</A></B>(3),

<B><A HREF="../man3/getnameinfo.3.html">getnameinfo</A></B>(3),

<B><A HREF="../man3/gai_strerror.3.html">gai_strerror</A></B>(3).

<A NAME="lbAL">&nbsp;</A>
<H2>SEE ALSO</H2>

<B><A HREF="../man3/getaddrinfo.3.html">getaddrinfo</A></B>(3),

<B><A HREF="../man3/getipnodebyaddr.3.html">getipnodebyaddr</A></B>(3),

<B><A HREF="../man3/getipnodebyname.3.html">getipnodebyname</A></B>(3),

<B><A HREF="../man3/getnameinfo.3.html">getnameinfo</A></B>(3),

<B><A HREF="../man3/inet_ntop.3.html">inet_ntop</A></B>(3),

<B><A HREF="../man3/inet_pton.3.html">inet_pton</A></B>(3),

<B><A HREF="../man3/resolver.3.html">resolver</A></B>(3),

<B><A HREF="../man5/hosts.5.html">hosts</A></B>(5),

<B><A HREF="../man7/hostname.7.html">hostname</A></B>(7),

<B><A HREF="../man8/named.8.html">named</A></B>(8),

<B>resolv+</B>(8)

<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">RETURN VALUE</A><DD>
<DT><A HREF="#lbAF">ERRORS</A><DD>
<DT><A HREF="#lbAG">FILES</A><DD>
<DT><A HREF="#lbAH">CONFORMING TO</A><DD>
<DT><A HREF="#lbAI">SYSV/POSIX EXTENSION</A><DD>
<DT><A HREF="#lbAJ">GNU EXTENSIONS</A><DD>
<DT><A HREF="#lbAK">NOTES</A><DD>
<DT><A HREF="#lbAL">SEE ALSO</A><DD>
</DL>
<HR>
This document was created by
<A HREF="http://localhost/cgi-bin/man/man2html">man2html</A>,
using the manual pages.<BR>
Time: 02:19:08 GMT, April 20, 2020
</BODY>
</HTML>
