<!--
-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Man page of UDP</TITLE>
</HEAD><BODY>
<H1>UDP</H1>
Section: Linux Programmer's Manual (7)<BR>Updated: 1998-10-02<BR><A HREF="#index">Index</A>
<A HREF="../index.html">Return to Main Contents</A><HR>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

udp - User Datagram Protocol for IPv4
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<B>#include &lt;<A HREF="file:///usr/include/sys/socket.h">sys/socket.h</A>&gt;</B>

<BR>

<B>#include &lt;<A HREF="file:///usr/include/netinet/in.h">netinet/in.h</A>&gt;</B>

<BR>

<B>udp_socket = socket(PF_INET, SOCK_DGRAM, 0);</B>

<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

This is an implementation of the User Datagram Protocol
described in RFC&nbsp;768.
It implements a connectionless, unreliable datagram packet service.
Packets may be reordered or duplicated before they arrive.
UDP generates and checks checksums to catch transmission errors.
<P>
When a UDP socket is created,
its local and remote addresses are unspecified.
Datagrams can be sent immediately using
<B><A HREF="../man2/sendto.2.html">sendto</A></B>(2)

or
<B><A HREF="../man2/sendmsg.2.html">sendmsg</A></B>(2)

with a valid destination address as an argument.
When
<B><A HREF="../man2/connect.2.html">connect</A></B>(2)

is called on the socket the default destination address is set and
datagrams can now be sent using
<B><A HREF="../man2/send.2.html">send</A></B>(2)

or
<B><A HREF="../man2/write.2.html">write</A></B>(2)

without specifying an destination address.
It is still possible to send to other destinations by passing an
address to
<B><A HREF="../man2/sendto.2.html">sendto</A></B>(2)

or
<B><A HREF="../man2/sendmsg.2.html">sendmsg</A></B>(2).

In order to receive packets the socket can be bound to an local
address first by using
<B><A HREF="../man2/bind.2.html">bind</A></B>(2).

Otherwise the socket layer will automatically assign
a free local port out of the range defined by
<I>net.ipv4.ip_local_port_range</I>

and bind the socket to
<I>INADDR_ANY</I>.

<P>
All receive operations return only one packet.
When the packet is smaller than the passed buffer only that much
data is returned, when it is bigger the packet is truncated and the
<B>MSG_TRUNC</B>

flag is set.
<I>MSG_WAITALL</I>

is not supported.
<P>
IP options may be sent or received using the socket options described in
<B><A HREF="../man7/ip.7.html">ip</A></B>(7).

They are only processed by the kernel when the appropriate sysctl
is enabled (but still passed to the user even when it is turned off).
See
<B><A HREF="../man7/ip.7.html">ip</A></B>(7).

<P>
When the
<B>MSG_DONTROUTE</B>

flag is set on sending the destination address must refer to an local
interface address and the packet is only sent to that interface.
<P>
By default Linux UDP does path MTU (Maximum Transmission Unit) discovery.
This means the kernel
will keep track of the MTU to a specific target IP address and return
<I>EMSGSIZE</I>

when a UDP packet write exceeds it.
When this happens the application should decrease the packet size.
Path MTU discovery can be also turned off using the
<B>IP_MTU_DISCOVER</B>

socket option or the
<B>ip_no_pmtu_disc</B>

sysctl, see
<B><A HREF="../man7/ip.7.html">ip</A></B>(7)

for details.
When turned off UDP will fragment outgoing UDP packets
that exceed the interface MTU.
However disabling it is not recommended
for performance and reliability reasons.
<A NAME="lbAE">&nbsp;</A>
<H3>Address Format</H3>

UDP uses the IPv4
<B>sockaddr_in</B>

address format described in
<B><A HREF="../man7/ip.7.html">ip</A></B>(7).

<A NAME="lbAF">&nbsp;</A>
<H3>Error Handling</H3>

All fatal errors will be passed to the user as an error return even
when the socket is not connected.
This includes asynchronous errors
received from the network.
You may get an error for an earlier packet
that was sent on the same socket.
This behavior differs from many other BSD socket implementations
which don't pass any errors unless the socket is connected.
Linux's behavior is mandated by
<B>RFC&nbsp;1122</B>.

<P>
For compatibility with legacy code in Linux 2.0 and 2.2
it was possible to set the
<B>SO_BSDCOMPAT</B>

SOL_SOCKET option to receive remote errors only when the socket has been
connected (except for
<B>EPROTO</B>

and
<B>EMSGSIZE</B>).

Locally generated errors are always passed.
Support for this socket option was removed in later kernels; see
<B><A HREF="../man7/socket.7.html">socket</A></B>(7)

for further information.
<P>
When the
<B>IP_RECVERR</B>

option is enabled all errors are stored in the socket error queue
and can be received by
<B><A HREF="../man2/recvmsg.2.html">recvmsg</A></B>(2)

with the
<B>MSG_ERRQUEUE</B>

flag set.
<A NAME="lbAG">&nbsp;</A>
<H3>Socket Options</H3>

To set or get a UDP socket option, call
<B><A HREF="../man2/getsockopt.2.html">getsockopt</A></B>(2)

to read or
<B><A HREF="../man2/setsockopt.2.html">setsockopt</A></B>(2)

to write the option with the option level argument set to
<B>IPPROTO_UDP</B>.

<DL COMPACT>
<DT><B>UDP_CORK</B> (since Linux 2.5.44)

<DD>
If this option is enabled, then all data output on this socket
is accumulated into a single datagram that is transmitted when
the option is disabled.
This option should not be used in code intended to be
portable.

</DL>
<A NAME="lbAH">&nbsp;</A>
<H3>Ioctls</H3>

These ioctls can be accessed using
<B><A HREF="../man2/ioctl.2.html">ioctl</A></B>(2).

The correct syntax is:
<P>

<DL COMPACT><DT><DD>
<PRE>
<B>int</B><I> value;</I>
<I>error</I><B> = ioctl(</B><I>udp_socket</I><B>, </B><I>ioctl_type</I><B>, &amp;</B><I>value</I><B>);</B>
</PRE>

</DL>

<DL COMPACT>
<DT><B>FIONREAD</B> (<B>SIOCINQ</B>)

<DD>
Gets a pointer to an integer as argument.
Returns the size of the next pending datagram in the integer in bytes,
or 0 when no datagram is pending.
<DT><B>TIOCOUTQ</B> (<B>SIOCOUTQ</B>)

<DD>
Returns the number of data bytes in the local send queue.
Only supported with Linux 2.4 and above.
</DL>
<P>

In addition all ioctls documented in
<B><A HREF="../man7/ip.7.html">ip</A></B>(7)

and
<B><A HREF="../man7/socket.7.html">socket</A></B>(7)

are supported.
<A NAME="lbAI">&nbsp;</A>
<H2>ERRORS</H2>

All errors documented for
<B><A HREF="../man7/socket.7.html">socket</A></B>(7)

or
<B><A HREF="../man7/ip.7.html">ip</A></B>(7)

may be returned by a send or receive on a UDP socket.
<P>
<B>ECONNREFUSED</B>

No receiver was associated with the destination address.
This might be caused by a previous packet sent over the socket.
<A NAME="lbAJ">&nbsp;</A>
<H2>VERSIONS</H2>

IP_RECVERR is a new feature in Linux 2.2.


<A NAME="lbAK">&nbsp;</A>
<H2>SEE ALSO</H2>

<B><A HREF="../man7/ip.7.html">ip</A></B>(7),

<B><A HREF="../man7/raw.7.html">raw</A></B>(7),

<B><A HREF="../man7/socket.7.html">socket</A></B>(7)

<P>
RFC&nbsp;768 for the User Datagram Protocol.
<BR>

RFC&nbsp;1122 for the host requirements.
<BR>

RFC&nbsp;1191 for a description of path MTU discovery.
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DL>
<DT><A HREF="#lbAE">Address Format</A><DD>
<DT><A HREF="#lbAF">Error Handling</A><DD>
<DT><A HREF="#lbAG">Socket Options</A><DD>
<DT><A HREF="#lbAH">Ioctls</A><DD>
</DL>
<DT><A HREF="#lbAI">ERRORS</A><DD>
<DT><A HREF="#lbAJ">VERSIONS</A><DD>
<DT><A HREF="#lbAK">SEE ALSO</A><DD>
</DL>
<HR>
This document was created by
<A HREF="http://localhost/cgi-bin/man/man2html">man2html</A>,
using the manual pages.<BR>
Time: 02:41:51 GMT, April 20, 2020
</BODY>
</HTML>
